<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{.title}}</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/static/public/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/public/favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/public/favicon/favicon-32x32.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#3b82f6",
              secondary: "#64748b",
              success: "#10b981",
              warning: "#f59e0b",
              danger: "#ef4444",
            },
          },
        },
      };
    </script>
    <script
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>
  </head>
  <body class="bg-gray-100 min-h-screen">
    <div
      x-data="nginxManager()"
      x-init="init()"
      class="container mx-auto px-4 py-8"
    >
      <!-- Header -->
      <div class="bg-white rounded-lg shadow-md mb-6 p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">{{.title}}</h1>
        <p class="text-gray-600">
          Gerencie configurações do nginx através de uma interface web simples e
          intuitiva
        </p>
      </div>

      <!-- Status Card -->
      <div class="bg-white rounded-lg shadow-md mb-6 p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">
          Status do Nginx
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="bg-gray-50 rounded-lg p-4">
            <div class="flex items-center">
              <div
                class="w-3 h-3 rounded-full mr-3"
                :class="status.is_installed ? 'bg-green-500' : 'bg-red-500'"
              ></div>
              <span class="text-sm font-medium text-gray-700">Instalado</span>
            </div>
            <p
              class="text-xs text-gray-500 mt-1"
              x-text="status.is_installed ? 'Sim' : 'Não'"
            ></p>
          </div>

          <div class="bg-gray-50 rounded-lg p-4">
            <div class="flex items-center">
              <div
                class="w-3 h-3 rounded-full mr-3"
                :class="status.is_running ? 'bg-green-500' : 'bg-red-500'"
              ></div>
              <span class="text-sm font-medium text-gray-700">Executando</span>
            </div>
            <p
              class="text-xs text-gray-500 mt-1"
              x-text="status.is_running ? 'Sim' : 'Não'"
            ></p>
          </div>

          <div class="bg-gray-50 rounded-lg p-4">
            <div class="flex items-center">
              <div
                class="w-3 h-3 rounded-full mr-3"
                :class="status.config_valid ? 'bg-green-500' : 'bg-red-500'"
              ></div>
              <span class="text-sm font-medium text-gray-700"
                >Configuração</span
              >
            </div>
            <p
              class="text-xs text-gray-500 mt-1"
              x-text="status.config_valid ? 'Válida' : 'Inválida'"
            ></p>
          </div>

          <div class="bg-gray-50 rounded-lg p-4">
            <div class="flex items-center">
              <span class="text-sm font-medium text-gray-700">Versão</span>
            </div>
            <p
              class="text-xs text-gray-500 mt-1"
              x-text="status.version || 'N/A'"
            ></p>
          </div>
        </div>

        <!-- Error message if config is invalid -->
        <div
          x-show="!status.config_valid && status.config_error"
          class="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg"
        >
          <p class="text-sm text-red-700">
            <strong>Erro na configuração:</strong>
            <span x-text="status.config_error"></span>
          </p>
        </div>
      </div>

      <!-- Actions -->
      <div class="bg-white rounded-lg shadow-md mb-6 p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Ações</h2>
        <div class="flex flex-wrap gap-3">
          <button
            @click="validateConfig()"
            class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200"
          >
            <span x-show="!loading.validate">Validar Configuração</span>
            <span x-show="loading.validate" class="flex items-center">
              <svg
                class="animate-spin -ml-1 mr-3 h-4 w-4 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              Validando...
            </span>
          </button>

          <button
            @click="reloadNginx()"
            :disabled="!status.config_valid"
            :class="status.config_valid ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-300 cursor-not-allowed'"
            class="px-4 py-2 text-white rounded-lg transition-colors duration-200"
          >
            <span x-show="!loading.reload">Recarregar</span>
            <span x-show="loading.reload" class="flex items-center">
              <svg
                class="animate-spin -ml-1 mr-3 h-4 w-4 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              Recarregando...
            </span>
          </button>

          <button
            @click="restartNginx()"
            :disabled="!status.config_valid"
            :class="status.config_valid ? 'bg-orange-500 hover:bg-orange-600' : 'bg-gray-300 cursor-not-allowed'"
            class="px-4 py-2 text-white rounded-lg transition-colors duration-200"
          >
            <span x-show="!loading.restart">Reiniciar</span>
            <span x-show="loading.restart" class="flex items-center">
              <svg
                class="animate-spin -ml-1 mr-3 h-4 w-4 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              Reiniciando...
            </span>
          </button>

          <button
            @click="refreshStatus()"
            class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200"
          >
            <span x-show="!loading.refresh">Atualizar Status</span>
            <span x-show="loading.refresh" class="flex items-center">
              <svg
                class="animate-spin -ml-1 mr-3 h-4 w-4 text-white"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              Atualizando...
            </span>
          </button>
        </div>
      </div>

      <!-- Configuration Files -->
      <div class="bg-white rounded-lg shadow-md mb-6 p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">
          Arquivos de Configuração
        </h2>

        <div x-show="loading.configs" class="text-center py-8">
          <svg
            class="animate-spin mx-auto h-8 w-8 text-blue-500"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            ></path>
          </svg>
          <p class="mt-2 text-gray-600">Carregando arquivos...</p>
        </div>

        <div x-show="!loading.configs" class="space-y-3">
          <template x-for="config in configs" :key="config.name">
            <div
              class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors duration-200"
            >
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <div
                    class="w-3 h-3 rounded-full mr-3"
                    :class="config.is_active ? 'bg-green-500' : 'bg-gray-400'"
                  ></div>
                  <div>
                    <h3
                      class="font-medium text-gray-800"
                      x-text="config.name"
                    ></h3>
                    <p class="text-sm text-gray-500">
                      Tamanho:
                      <span x-text="formatFileSize(config.size)"></span> |
                      Modificado:
                      <span x-text="formatDate(config.modified_time)"></span>
                    </p>
                  </div>
                </div>
                <div class="flex gap-2">
                  <button
                    @click="editConfig(config.name)"
                    class="px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors duration-200"
                  >
                    Editar
                  </button>
                </div>
              </div>
            </div>
          </template>

          <div
            x-show="configs.length === 0"
            class="text-center py-8 text-gray-500"
          >
            Nenhum arquivo de configuração encontrado
          </div>
        </div>
      </div>

      <!-- Notification -->
      <div
        x-show="notification.show"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 transform translate-y-2"
        x-transition:enter-end="opacity-100 transform translate-y-0"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100 transform translate-y-0"
        x-transition:leave-end="opacity-0 transform translate-y-2"
        class="fixed bottom-4 right-4 max-w-sm w-full"
      >
        <div
          class="rounded-lg p-4 shadow-lg"
          :class="{
                     'bg-green-500 text-white': notification.type === 'success',
                     'bg-red-500 text-white': notification.type === 'error',
                     'bg-blue-500 text-white': notification.type === 'info',
                     'bg-yellow-500 text-white': notification.type === 'warning'
                 }"
        >
          <div class="flex items-center justify-between">
            <p class="text-sm" x-text="notification.message"></p>
            <button
              @click="notification.show = false"
              class="ml-4 text-white hover:text-gray-200"
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="/static/js/app.js"></script>
  </body>
</html>
